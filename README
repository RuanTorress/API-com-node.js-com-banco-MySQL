üìä API Din√¢mica de Gr√°ficos (Node.js + Express + Sequelize + MySQL)

Esta API tem como objetivo ler dados de um banco MySQL local e retornar valores formatados especificamente para gr√°ficos de dashboard, como pizza, linha e barra.
Os endpoints retornam os dados diretamente no formato utilizado por bibliotecas como Chart.js, ApexCharts ou ECharts.

üìÅ 1. Estrutura do Projeto
/api
 ‚îú‚îÄ‚îÄ app.js
 ‚îú‚îÄ‚îÄ models/
 ‚îÇ    ‚îî‚îÄ‚îÄ db.js
 ‚îú‚îÄ‚îÄ package.json
 ‚îî‚îÄ‚îÄ README.md  (este arquivo)

üß© 2. Tecnologias Utilizadas

Node.js

Express

Sequelize

MySQL 8

JavaScript

üóÑÔ∏è 3. Requisitos do Banco de Dados

A API depende das seguintes tabelas no banco cadastro:

üìå Tabela vendas
coluna	tipo
categoria	VARCHAR
quantidade	INT
üìå Tabela vendas_mensais
coluna	tipo
mes	VARCHAR
total	INT
üìå Tabela usuarios
coluna	tipo
sexo	VARCHAR
üöÄ 4. Instala√ß√£o e Execu√ß√£o
1. Instalar depend√™ncias
npm install

2. Configurar o banco

No arquivo:

/models/db.js


Informe:

host

user

password

database (cadastro)

3. Rodar o servidor
node app.js


Ou:

npx nodemon app.js

API dispon√≠vel em:
http://localhost:8081

üîÑ 5. Endpoints Dispon√≠veis
üéØ GET /chart/pizza

Retorna dados formatados para gr√°ficos de pizza usando a tabela vendas.

Exemplo de Resposta
{
  "tipo": "pizza",
  "dados": {
    "labels": ["Eletr√¥nicos","Roupas","Alimentos"],
    "datasets":[{ "data":[40,25,70] }]
  }
}

üìà GET /chart/linha

Retorna valores mensais de vendas (tabela vendas_mensais), ordenados por ID.

Exemplo:
{
  "tipo": "linha",
  "dados": {
    "labels": ["Janeiro","Fevereiro","Mar√ßo"],
    "datasets":[{ "label":"Total mensal", "data":[120,150,130] }]
  }
}

üìä GET /chart/barra

Retorna dados de vendas por categoria, ordenados de forma decrescente.

Exemplo:
{
  "tipo":"barra",
  "dados":{
    "labels":["Alimentos","Eletr√¥nicos","Roupas"],
    "datasets":[{ "label":"Quantidade por categoria","data":[70,40,25] }]
  }
}

üßë‚Äçü§ù‚Äçüßë GET /chart/pizzaUsuarios

Retorna quantidade de usu√°rios por sexo.

Exemplo:
{
  "tipo":"pizzaUsuarios",
  "dados":{
    "labels":["Masculino","Feminino"],
    "datasets":[{ "data":[3,3] }]
  }
}

üõ†Ô∏è 6. Funcionamento do C√≥digo

Cada rota executa um SQL direto via sequelize.query(), processa os dados e os transforma no formato adequado para dashboards.

Exemplo interno:
const [rows] = await sequelize.query("SELECT categoria AS label, quantidade AS value FROM vendas");
return {
  labels: rows.map(r => r.label),
  datasets: [{ data: rows.map(r => r.value) }]
};

‚ùó Erros Comuns e Solu√ß√µes
Erro	Causa	Solu√ß√£o
SequelizeAccessDeniedError	Usu√°rio do MySQL inv√°lido	Ajustar credenciais em models/db.js
Unknown column 'mes'	Estrutura do banco diferente	Verificar tabelas
API retorna vazio	Banco sem dados	Inserir registros de teste
üß™ 7. Teste R√°pido via Browser ou Curl
Pizza:
http://localhost:8081/chart/pizza

Linha:
http://localhost:8081/chart/linha

Barra:
http://localhost:8081/chart/barra

Pizza de usu√°rios:
http://localhost:8081/chart/pizzaUsuarios

‚úî 8. Resultado Esperado

A API retorna dados formatados e prontos para gr√°ficos, permitindo constru√ß√£o f√°cil de dashboards din√¢micos.

üìå 9. Conclus√£o

Esta API foi estruturada para fornecer dados de banco de forma simples, r√°pida e formatada, permitindo integra√ß√µes diretas com dashboards e aplica√ß√µes front-end.

Caso deseje expandir, recomenda-se adicionar:

filtros de data,

autentica√ß√£o JWT,

testes unit√°rios,

Swagger/OpenAPI.
